[
  {
    "objectID": "index.html#enjeux",
    "href": "index.html#enjeux",
    "title": "Le format Parquet et l‚Äô√©cosyst√®me DuckDB: l‚Äôessayer c‚Äôest l‚Äôadopter!",
    "section": "Enjeux",
    "text": "Enjeux\n\nLe choix d‚Äôun format de donn√©es r√©pond √† un arbitrage entre plusieurs crit√®res :\n\nPublic cible\nFinalit√© (traitement, analyse, diffusion)\nVolum√©trie\nInterop√©rabilit√©"
  },
  {
    "objectID": "index.html#formats-traditionnels",
    "href": "index.html#formats-traditionnels",
    "title": "Le format Parquet et l‚Äô√©cosyst√®me DuckDB: l‚Äôessayer c‚Äôest l‚Äôadopter!",
    "section": "Formats traditionnels",
    "text": "Formats traditionnels\n\nFormats de donn√©es adh√©rents √† un langage (sas7bdat, RDS, fst, etc.)\n\nNon-interop√©rables -&gt; √† √©viter !\n\n\n\n\nLe format CSV\n\nInterop√©rable et simple d‚Äôutilisation\nPas de gestion des m√©ta-donn√©es\nPeu adapt√© aux donn√©es volumineuses"
  },
  {
    "objectID": "index.html#limites-du-csv",
    "href": "index.html#limites-du-csv",
    "title": "Le format Parquet et l‚Äô√©cosyst√®me DuckDB: l‚Äôessayer c‚Äôest l‚Äôadopter!",
    "section": "Limites du CSV",
    "text": "Limites du CSV\n\n\n\nDes performances limit√©es\n\nStockage : non-compress√© -&gt; espace disque √©lev√©\nLecture : ‚Äúorient√©-ligne‚Äù -&gt; performances faibles\n\n\n\n\n\n\n\n\n\nPas de typage des donn√©es √† l‚Äô√©criture du fichier\n\nDemande expertise et pr√©caution √† la lecture\nExemple: 01004 pour le code commune d‚ÄôAmb√©rieu-en-Bugey"
  },
  {
    "objectID": "index.html#un-format-l√©ger",
    "href": "index.html#un-format-l√©ger",
    "title": "Le format Parquet et l‚Äô√©cosyst√®me DuckDB: l‚Äôessayer c‚Äôest l‚Äôadopter!",
    "section": "Un format l√©ger ",
    "text": "Un format l√©ger \n\nStockage :\n\nCompression : entre 5 et 20 fois plus l√©ger qu‚Äôun CSV\n\n\n\n\n\n\n\n\n\nExemple: Recensement de la Population\n\n\n\nFicher d√©tail : 20 millions de lignes, 92 variables\n\nCSV: &gt; 4Go\nParquet: &lt; 500Mo"
  },
  {
    "objectID": "index.html#un-format-efficace",
    "href": "index.html#un-format-efficace",
    "title": "Le format Parquet et l‚Äô√©cosyst√®me DuckDB: l‚Äôessayer c‚Äôest l‚Äôadopter!",
    "section": "Un format efficace",
    "text": "Un format efficace\n\nLecture :\n\nJusqu‚Äô√† 34x plus rapide qu‚Äôun CSV\n\n\n\n\n‚ÄúOrient√© colonne‚Äù\n\nOptimis√© pour les traitements analytiques\nLimite la quantit√© de donn√©es √† mettre en m√©moire\nCon√ßu pour √™tre √©crit une fois mais lu fr√©quemment"
  },
  {
    "objectID": "index.html#un-format-universel-et-fiable",
    "href": "index.html#un-format-universel-et-fiable",
    "title": "Le format Parquet et l‚Äô√©cosyst√®me DuckDB: l‚Äôessayer c‚Äôest l‚Äôadopter!",
    "section": "Un format universel et fiable",
    "text": "Un format universel et fiable\n\nGestion native des m√©ta-donn√©es\n\nD√©finition automatique d‚Äôun sch√©ma (noms, types)\nMise √† disposition plus robuste\n\n\n\n\nInterop√©rable\n\n\n\n\nOpen-source\n\n\n\n\nNon lisible par un humain mais de plus en plus de visualiseurs en ligne"
  },
  {
    "objectID": "index.html#parquet-un-format-pl√©biscit√©",
    "href": "index.html#parquet-un-format-pl√©biscit√©",
    "title": "Le format Parquet et l‚Äô√©cosyst√®me DuckDB: l‚Äôessayer c‚Äôest l‚Äôadopter!",
    "section": "Parquet : un format pl√©biscit√©",
    "text": "Parquet : un format pl√©biscit√©\nTout un √©cosyst√®me autour de Parquet:\n\nDes formats associ√©s : Iceberg, Delta\nDes acteurs importants s‚Äôappuient dessus:"
  },
  {
    "objectID": "index.html#parquet-quel-usage-√†-linsee",
    "href": "index.html#parquet-quel-usage-√†-linsee",
    "title": "Le format Parquet et l‚Äô√©cosyst√®me DuckDB: l‚Äôessayer c‚Äôest l‚Äôadopter!",
    "section": "Parquet: quel usage √† l‚ÄôInsee ?",
    "text": "Parquet: quel usage √† l‚ÄôInsee ?\n\nMise √† disposition interne de donn√©es: format privil√©gi√©\n\n\n\nDiffusion: pour les donn√©es lourdes\n\n\n\n\nPermis d‚Äôutiliser  pour de la valorisation de donn√©es administratives\n\nFin de l‚Äôh√©sitation entre tidyverse et data.table\nFin de la gu√©guerre  / \n\n\n\n\n\nSocle important dans les formations aux bonnes pratiques de l‚ÄôInsee"
  },
  {
    "objectID": "index.html#la-preuve",
    "href": "index.html#la-preuve",
    "title": "Le format Parquet et l‚Äô√©cosyst√®me DuckDB: l‚Äôessayer c‚Äôest l‚Äôadopter!",
    "section": "La preuve !",
    "text": "La preuve !"
  },
  {
    "objectID": "index.html#enjeu",
    "href": "index.html#enjeu",
    "title": "Le format Parquet et l‚Äô√©cosyst√®me DuckDB: l‚Äôessayer c‚Äôest l‚Äôadopter!",
    "section": "Enjeu",
    "text": "Enjeu\n\nParquet ne r√©sout pas tout\n\nL‚Äôespace disque est optimis√©\nLes donn√©es d√©compress√©es doivent passer en RAM\n\n\n\n\nLe framework adapt√© d√©pend de la volum√©trie\n\nPour la plupart des besoins : Arrow et DuckDB\nPour des besoins plus avanc√©s : Spark (de moins en moins pertinent, cf.¬†‚Äúbig data is dead‚Äù par Jordan Tigani)"
  },
  {
    "objectID": "index.html#les-frameworks",
    "href": "index.html#les-frameworks",
    "title": "Le format Parquet et l‚Äô√©cosyst√®me DuckDB: l‚Äôessayer c‚Äôest l‚Äôadopter!",
    "section": "Les frameworks",
    "text": "Les frameworks\n\nDeux frameworks de r√©f√©rence : Arrow et DuckDB\n\nOrientation fichier (Arrow) VS orientation BDD (DuckDB)\n\n\n\n\nTraitement en-m√©moire optimis√©\n\nOrient√©s-colonne\nLazy evaluation (prochaine slide)\n\n\n\n\n\nTr√®s bonne int√©gration:\n\nAvec le tidyverse ()\nAvec le syst√®me de stockage S3"
  },
  {
    "objectID": "index.html#exemple-simple-avec-duckdb",
    "href": "index.html#exemple-simple-avec-duckdb",
    "title": "Le format Parquet et l‚Äô√©cosyst√®me DuckDB: l‚Äôessayer c‚Äôest l‚Äôadopter!",
    "section": "Exemple simple avec duckdb",
    "text": "Exemple simple avec duckdb\nlibrary(duckdb)\ncon &lt;- dbConnect(duckdb::duckdb())\n\n# Lire un fichier Parquet\ndbGetQuery(con, \"\n  FROM 'data/recensement.parquet'\n  SELECT depcom, COUNT(*) AS n\n  WHERE dep = '01'\n  GROUP BY depcom\n\")\n\nLecture directe du fichier, SQL user friendly\nPas besoin d‚Äôimporter en m√©moire avant d‚Äôagir"
  },
  {
    "objectID": "index.html#int√©gration-avec-le-tidyverse",
    "href": "index.html#int√©gration-avec-le-tidyverse",
    "title": "Le format Parquet et l‚Äô√©cosyst√®me DuckDB: l‚Äôessayer c‚Äôest l‚Äôadopter!",
    "section": "Int√©gration avec le tidyverse",
    "text": "Int√©gration avec le tidyverse\nlibrary(dplyr)\nlibrary(duckdb)\n\ncon &lt;- dbConnect(duckdb())\n\nrp &lt;- tbl(con, \"data/recensement.parquet\")\n\nrp |&gt;\n  filter(dep == \"01\") |&gt;\n  select(depcom, idlogement) |&gt;\n  group_by(depcom) |&gt;\n  summarise(n = n()) |&gt;\n  collect()\n\ntbl() cr√©e une table lazy\nLes op√©rations sont retard√©es jusqu‚Äô√† collect():\n\nDuckDB optimise le plan pour gagner en performance"
  },
  {
    "objectID": "index.html#int√©gration-native-√†-s3",
    "href": "index.html#int√©gration-native-√†-s3",
    "title": "Le format Parquet et l‚Äô√©cosyst√®me DuckDB: l‚Äôessayer c‚Äôest l‚Äôadopter!",
    "section": "Int√©gration native √† S3",
    "text": "Int√©gration native √† S3\n\nInt√©gration native avec S3\n\nPour travailler sur des serveurs √† l‚Äô√©tat de l‚Äôart‚Ä¶\nPlut√¥t que sur des ordinateurs aux ressources limit√©es\n\nOn peut lire la donn√©e sur S3 presque comme si elle √©tait en local\n\nFROM 's3://bucket_name/filename.extension';\nSELECT *\nWHERE DEPT=='36'"
  },
  {
    "objectID": "index.html#duckdb-dans-le-navigateur",
    "href": "index.html#duckdb-dans-le-navigateur",
    "title": "Le format Parquet et l‚Äô√©cosyst√®me DuckDB: l‚Äôessayer c‚Äôest l‚Äôadopter!",
    "section": "DuckDB dans le navigateur",
    "text": "DuckDB dans le navigateur\n\nDuckDB WASM pour faire du DuckDB dans le navigateur :\n\nPour des dataviz r√©actives‚Ä¶ dans des sites statiques !\nBye bye les gal√®res de d√©ploiement de Shiny, Streamlit‚Ä¶\n\nSimple d‚Äôusage avec Observable (et donc Quarto!)"
  },
  {
    "objectID": "index.html#exemple",
    "href": "index.html#exemple",
    "title": "Le format Parquet et l‚Äô√©cosyst√®me DuckDB: l‚Äôessayer c‚Äôest l‚Äôadopter!",
    "section": "Exemple",
    "text": "Exemple\n\nhtml`\n  &lt;div style=\"display: flex; flex-direction: column; gap: 1rem;\"&gt;\n\n    &lt;!-- Search bar at the top --&gt;\n    &lt;div&gt;${viewof search}&lt;/div&gt;\n\n    &lt;!-- Two-column block --&gt;\n    &lt;div style=\"display: grid; grid-template-columns: 1fr 1fr; gap: 1rem; backgroundColor: '#293845';\"&gt;\n      &lt;div&gt;${produce_histo(dvf)}&lt;/div&gt;\n      &lt;div&gt;${viewof table_dvf}&lt;/div&gt;\n    &lt;/div&gt;\n\n\n  &lt;/div&gt;\n`\n\n\n\n\n\n\n\nviewof search = Inputs.select(cog, {format: x =&gt; x.LIBELLE, value: cog.find(t =&gt; t.LIBELLE == \"Grasse\")})\n\ncog = db.query(`SELECT * FROM read_csv_auto(\"https://minio.lab.sspcloud.fr/lgaliana/data/python-ENSAE/cog_2023.csv\") WHERE DEP == '06'`)\ndvf = db.query(query)\n\ndb = DuckDBClient.of({})\n\nquery = `\n  FROM read_parquet('https://minio.lab.sspcloud.fr/projet-formation/nouvelles-sources/data/geoparquet/dvf.parquet')\n  SELECT\n    CAST(date_mutation AS date) AS date,\n    valeur_fonciere, code_commune,\n    longitude, latitude, valeur_fonciere AS valeur_fonciere_bar\n  WHERE code_commune = '${search.COM}'\n`\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nviewof table_dvf = Inputs.table(dvf, {columns: [\"date\", \"valeur_fonciere\"], rows: 15})\n\nproduce_histo = function(dvf){\n  const histo = Plot.plot({\n  style: {backgroundColor: \"transparent\"},\n  marks: [\n    Plot.rectY(dvf, Plot.binX({y: \"count\"}, {x: \"valeur_fonciere\", fill: \"#ff562c\"})),\n    Plot.ruleY([0])\n  ]\n})\n  return histo\n}"
  },
  {
    "objectID": "index.html#cas-dusage-spatial-geoparquet",
    "href": "index.html#cas-dusage-spatial-geoparquet",
    "title": "Le format Parquet et l‚Äô√©cosyst√®me DuckDB: l‚Äôessayer c‚Äôest l‚Äôadopter!",
    "section": "Cas d‚Äôusage spatial : GeoParquet",
    "text": "Cas d‚Äôusage spatial : GeoParquet\n\nParquet peut contenir des donn√©es g√©ographiques\n\nCompatible avec la norme GeoParquet\nLecture possible via extension SPATIAL de DuckDB\n\nPermet :\n\nJointures spatiales\nCalculs de distance\nR√©cup√©ration des donn√©es sous forme sf dans R"
  },
  {
    "objectID": "index.html#conclusion-parquet-duckdb",
    "href": "index.html#conclusion-parquet-duckdb",
    "title": "Le format Parquet et l‚Äô√©cosyst√®me DuckDB: l‚Äôessayer c‚Äôest l‚Äôadopter!",
    "section": "Conclusion: Parquet + DuckDB =",
    "text": "Conclusion: Parquet + DuckDB =\n\nSimplicit√© et lisibilit√©\n\n\n\nPerformance\n\n\n\n\nInterop√©rabilit√©\n\n\n\n\nUn √©cosyst√®me cloud-ready, web-ready & spatial-ready"
  },
  {
    "objectID": "index.html#questions",
    "href": "index.html#questions",
    "title": "Le format Parquet et l‚Äô√©cosyst√®me DuckDB: l‚Äôessayer c‚Äôest l‚Äôadopter!",
    "section": "Questions ? üôã",
    "text": "Questions ? üôã"
  },
  {
    "objectID": "index.html#partitionnement-tri",
    "href": "index.html#partitionnement-tri",
    "title": "Le format Parquet et l‚Äô√©cosyst√®me DuckDB: l‚Äôessayer c‚Äôest l‚Äôadopter!",
    "section": "Partitionnement & tri",
    "text": "Partitionnement & tri\n\nPartitionner ou ordonner les donn√©es\n\n\n\n\n\n\n\n\n\n\n\n\nL‚Äôart de bien partitionner\n\n\n\nPartitionner par une/des variable(s) d‚Äôint√©r√™t si gros fichier\n\nEviter de cr√©er de nombreux petits (&lt; 128Mo) fichiers\n\nSinon ordonner les donn√©es avant d‚Äô√©crire le fichier (cf.¬†Eric Mauvi√®re)"
  },
  {
    "objectID": "index.html#exemple-anatomie",
    "href": "index.html#exemple-anatomie",
    "title": "Le format Parquet et l‚Äô√©cosyst√®me DuckDB: l‚Äôessayer c‚Äôest l‚Äôadopter!",
    "section": "Exemple: anatomie",
    "text": "Exemple: anatomie\n```{ojs}\nviewof search = Inputs.select(cog, {format: x =&gt; x.LIBELLE, value: cog.find(t =&gt; t.LIBELLE == \"Grasse\")})\n\ncog = db.query(`SELECT * FROM read_csv_auto(\"https://minio.lab.sspcloud.fr/lgaliana/data/python-ENSAE/cog_2023.csv\") WHERE DEP == '06'`)\ndvf = db.query(query)\n\ndb = DuckDBClient.of({})\n\nquery = `\n  FROM read_parquet('https://minio.lab.sspcloud.fr/projet-formation/nouvelles-sources/data/geoparquet/dvf.parquet')\n  SELECT\n    CAST(date_mutation AS date) AS date,\n    valeur_fonciere, code_commune,\n    longitude, latitude, valeur_fonciere AS valeur_fonciere_bar\n  WHERE code_commune = '${search.COM}'\n`\n```\nAvec un peu de code  suppl√©mentaire (voir sur )"
  }
]